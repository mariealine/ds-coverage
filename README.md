# Design System Refactor Radar

Design system refactor radar & AI guidelines for any frontend project.

Detect hardcoded design tokens, audit component APIs, plan library migrations, and scaffold Cursor rules â€” all from a single config file. Zero runtime dependencies.

## What it does

1. **Scans** your codebase for hardcoded values (colors, typography, spacing, radius, shadows...) using configurable regex patterns
2. **Audits** component APIs for compliance (prop naming, size values, architecture patterns)
3. **Plans migrations** between component libraries (source â†’ target mapping with guidelines)
4. **Generates a dashboard** â€” a self-contained HTML file with interactive charts, tables, and filters
5. **Scaffolds AI rules** â€” Cursor rules & skills that keep your AI assistant aligned with your design system

![Design System Refactor Radar dashboard](docs/dashboard-screenshot.png)

*The generated dashboard: coverage metrics, violations by category (colors, typography, spacing, radius, shadows, dark mode), migration flags, and a searchable file-by-file violation table.*

## Key concepts (for beginners)

- **Design system** â€” Your shared colors, typography, spacing, and component patterns. Design System Refactor Radar helps you keep the codebase consistent with these decisions.
- **Violation** â€” A place in the code where a hardcoded value (e.g. `#ff0000` or `text-sm`) is used instead of a design token or convention. The scanner finds these so you can fix them.
- **Coverage** â€” The share of files (or lines) that have no violations. Higher coverage = more consistent use of your design system.
- **Dashboard** â€” A single HTML file generated by the scan. Open it in a browser to explore violations, components, and migration plans.
- **Config** â€” One file (e.g. `design-system-refactor-radar.config.js` or `design-system-refactor-radar.config.mjs`) defines what to scan, which patterns to check, and where your components live. Run `npx design-system-refactor-radar init` to create it.

**Suggested first run:** `npx design-system-refactor-radar init` (answer the wizard), then `npx design-system-refactor-radar --open` to scan and open the dashboard.

## Quick start

```bash
# Install
npm install --save-dev design-system-refactor-radar

# Interactive setup wizard
npx design-system-refactor-radar init

# Scan your codebase
npx design-system-refactor-radar --open
```

### Manual installation (without npm)

To use Design System Refactor Radar locally without publishing to npm (e.g. from a clone of the repo):

1. **Clone and build the package**

```bash
git clone <repo-url> design-system-refactor-radar
cd design-system-refactor-radar
npm install
npm run build
```

2. **Use it from another project**

From a repo at the same level as `design-system-refactor-radar` (e.g. `valuation-pack` next to the package):

- In the projectâ€™s `package.json`, add a devDependency:

```json
"devDependencies": {
  "design-system-refactor-radar": "file:../design-system-refactor-radar"
}
```

- Then install dependencies (`pnpm install`, `npm install`, or `yarn install`).

After that, `npx design-system-refactor-radar`, `npx design-system-refactor-radar init`, etc. use the local built version. You can also use the shorthand `npx dsrr`.

The `init` wizard asks about your stack (CSS methodology, framework, component architecture) and generates:

- `design-system-refactor-radar.config.mjs` â€” your config file with patterns matching your stack (or .js / .cjs depending on setup)
- `.cursor/rules/design-system-compliance.mdc` â€” AI compliance rule
- `.cursor/rules/ui-component-creation.mdc` â€” AI component creation rule
- `.cursor/skills/design-system-compliance/SKILL.md` â€” **AI skill: read and edit this file** to adapt the protocol to your project and get full value from the tool (see [AI guidelines](#ai-guidelines))

## Works with any stack

Design System Refactor Radar is **library-agnostic**. It ships with presets for common stacks, and you can define custom patterns for anything:

| CSS Methodology | What it detects |
|---|---|
| **Tailwind CSS** | `bg-gray-500`, `text-sm`, `rounded-lg`, `shadow-md`, `dark:` |
| **CSS Modules** | `#ff0000`, `font-size: 14px`, `border-radius: 8px` |
| **CSS-in-JS** | `color: '#hex'`, `fontSize: 14`, `borderRadius: 8` |
| **Vanilla CSS / SCSS** | `#hex`, `rgba()`, `font-size: 14px` |
| **Custom** | Any regex pattern you define |

## CLI commands

### `npx design-system-refactor-radar` (scan)

Scans your codebase and generates a JSON report + HTML dashboard.

```bash
npx design-system-refactor-radar              # scan and generate dashboard
npx design-system-refactor-radar --open       # scan and open dashboard in browser
npx design-system-refactor-radar --dry-run    # scan without writing files
npx design-system-refactor-radar --silent     # no console output
npx design-system-refactor-radar --dir <path> # custom project root
```

### `npx design-system-refactor-radar init`

Interactive setup wizard that configures your project.

```bash
npx design-system-refactor-radar init                # interactive wizard
npx design-system-refactor-radar init --force        # overwrite existing files
npx design-system-refactor-radar init --no-interactive  # skip wizard, use existing config
npx design-system-refactor-radar init --target cursor   # only generate Cursor files
npx design-system-refactor-radar init --dry-run      # preview without writing
```

## Dashboard

The generated dashboard is a single HTML file with **up to 5 tabs** (visible tabs depend on your config: component analysis, migration, and roadmap can be enabled or disabled).

- **Metrics â€” App** â€” Always shown. App-wide compliance and violations.
- **Metrics â€” Design System** â€” Shown if component analysis is enabled.
- **Components â€” API Redesign** â€” Shown if component analysis is enabled.
- **Migration Plan** â€” Shown if migration is enabled and you have at least one component mapping.
- **Refactoring Roadmap** â€” Shown if roadmap is enabled.

### Metrics â€” App
Coverage ring, violations by category, flag badges, searchable/sortable file table with per-file violation detail.

### Metrics â€” Design System
Token compliance score per component. Score = % of lines free from hardcoded values.

### Components â€” API Redesign
Audit of reusable components: CVA usage, prop naming, size values, compoundVariants. Compliance scoring with expandable issue details.

### Migration Plan
Component-by-component migration guide organized by complexity:
- **Simple** â€” Direct swap, compatible API
- **Moderate** â€” Prop mapping needed, some logic adjustments
- **Complex** â€” Significant refactoring required

Each card shows: source â†’ target, guidelines, prop mapping, breaking changes, affected files, effort estimate.

### Refactoring Roadmap
Prioritized migration phases with business cases, directory heatmap, quick wins list.

## Configuration

The config file (e.g. `design-system-refactor-radar.config.js` or `design-system-refactor-radar.config.mjs`) controls everything. Run `npx design-system-refactor-radar init` to generate one, or create it manually:

```js
/** @type {import('design-system-refactor-radar/config').DsCoverageConfig} */
export default {
  // What to scan
  scanDir: "src",
  extensions: [".tsx", ".jsx"],
  exclude: ["node_modules/", "dist/", ".test.", ".spec."],

  // Violation categories â€” define patterns for YOUR stack
  violations: {
    colors: {
      enabled: true,
      label: "Colors",
      icon: "ðŸŽ¨",
      color: "oklch(0.637 0.237 25.331)",
      pattern: "your-color-pattern-here",
    },
    typography: {
      enabled: true,
      label: "Typography",
      icon: "ðŸ”¤",
      color: "oklch(0.723 0.22 70.08)",
      pattern: "your-typography-pattern-here",
      deduplicateByLine: true,
    },
  },

  // Component API analysis
  componentAnalysis: {
    enabled: true,
    directories: ["components/ui/"],
    primaryDirectory: "components/ui/",
    api: {
      requireCVA: false,
      expectedProps: ["variant", "size"],
      expectedSizes: ["small", "medium", "large"],
    },
  },

  // Migration planning (optional)
  migration: {
    enabled: true,
    targetDS: "shadcn/ui",
    mappings: [
      {
        source: "OldButton",
        sourceImportPattern: "@company/old-ui",
        target: "Button",
        targetImportPath: "@/components/ui/button",
        complexity: "simple",
        guidelines: "1. Update import path\n2. Rename 'intent' to 'variant'",
        propMapping: "intent â†’ variant",
        effort: "~15min",
      },
    ],
  },
};
```

See `design-system-refactor-radar.config.example.js` for a full annotated example.

## AI guidelines

The `init` command generates Cursor rules that stay in sync with your scanner config. Your AI assistant uses these to enforce the **same rules** the scanner detects.

### Read and customize the skill (SKILL.md) â€” get 100% out of the tool

**The design-system-compliance skill (`SKILL.md`) is the main file your AI assistant loads when building or editing UI.** To get full value from Design System Refactor Radar:

1. **Read it** right after running `init` â€” it summarizes the protocol (tokens, component hierarchy, Boy Scout Rule, flagging).
2. **Edit it** to match *your* project: your token names, your component directory paths, your conventions. The generated content is a starting point; your teamâ€™s decisions belong in this file.
3. **Keep it in sync** with how you work. When your design system evolves, update the skill so the AI keeps giving aligned suggestions.

If you skip this step, the AI still has the long-form rules (`.mdc`), but the skill is the concise, project-specific checklist it uses most. **Customizing `SKILL.md` is how you make the tool fully yours.**

Generated files:

| File | Purpose |
|---|---|
| `.cursor/skills/design-system-compliance/SKILL.md` | **Read and customize.** Main skill the AI uses for UI work. Adapt tokens, paths, and conventions here for full benefit. |
| `.cursor/rules/design-system-compliance.mdc` | Full compliance protocol â€” violation checklist, decision hierarchy, Boy Scout Rule, flagging conventions |
| `.cursor/rules/ui-component-creation.mdc` | Component creation standards â€” architecture, prop naming, accessibility checklist |

Also generated for Claude (`.claude/skills/`) and generic agents (`.agents/skills/`). Same idea: **open the skill, read it, then edit it** for your project.

After changing your *config*, re-run `npx design-system-refactor-radar init --force` to regenerate the rules. If youâ€™ve customized `SKILL.md` by hand, back up your edits before using `--force`, or merge them back after regenerating.

## Flagging conventions

Annotate code for future migration:

```tsx
// @ds-migrate: simple | Replace hardcoded color with semantic token
// @ds-migrate: complex | Custom dropdown should use <Select> from DS.
//   Risks: keyboard navigation conflicts. Cost: ~2h.
// @ds-todo: Create <Chip> component â€” used in 3 places for filter tags
```

The scanner counts flags and the dashboard shows them. The roadmap prioritizes flagged files.

## Programmatic API

```js
import { run, init } from "design-system-refactor-radar";

// Run scan
const { report, dashboardHtml } = await run({
  projectRoot: process.cwd(),
  config: { scanDir: "src" },
});

// Run init
await init({
  projectRoot: process.cwd(),
  targets: ["cursor"],
  force: true,
});
```

## Requirements

- Node.js >= 20.0.0
- Zero runtime dependencies

## License

MIT
